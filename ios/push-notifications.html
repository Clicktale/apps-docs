
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Push Notifications Â· Clicktale for Apps</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="advanced-features.html" />
    
    
    <link rel="prev" href="using-events.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    General
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../general/data-types.html">
            
                <a href="../general/data-types.html">
            
                    
                    Data Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../general/performance.html">
            
                <a href="../general/performance.html">
            
                    
                    Performance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../general/hybrid-applications.html">
            
                <a href="../general/hybrid-applications.html">
            
                    
                    Hybrid Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="../general/cordova.html">
            
                <a href="../general/cordova.html">
            
                    
                    Cordova Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="../general/faq.html">
            
                <a href="../general/faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    iOS
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="getting-started.html">
            
                <a href="getting-started.html">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="privacy.html">
            
                <a href="privacy.html">
            
                    
                    Privacy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="swift-integration.html">
            
                <a href="swift-integration.html">
            
                    
                    Swift Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="using-events.html">
            
                <a href="using-events.html">
            
                    
                    Using Events
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.5" data-path="push-notifications.html">
            
                <a href="push-notifications.html">
            
                    
                    Push Notifications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="advanced-features.html">
            
                <a href="advanced-features.html">
            
                    
                    Advanced Features
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Android
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../android/getting-started.html">
            
                <a href="../android/getting-started.html">
            
                    
                    Getting Started
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../android/privacy.html">
            
                <a href="../android/privacy.html">
            
                    
                    Privacy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../android/kotlin-integration.html">
            
                <a href="../android/kotlin-integration.html">
            
                    
                    Kotlin Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../android/using-events.html">
            
                <a href="../android/using-events.html">
            
                    
                    Using Events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../android/push-notifications.html">
            
                <a href="../android/push-notifications.html">
            
                    
                    Push Notifications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../android/advanced-features.html">
            
                <a href="../android/advanced-features.html">
            
                    
                    Advanced Features
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Heatmaps
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../heatmaps/setting-up-heatmaps.html">
            
                <a href="../heatmaps/setting-up-heatmaps.html">
            
                    
                    Setting up Heatmaps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../heatmaps/using-heatmaps.html">
            
                <a href="../heatmaps/using-heatmaps.html">
            
                    
                    Using Heatmaps
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Working with Other SDKs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../integrations/about-integrations.html">
            
                <a href="../integrations/about-integrations.html">
            
                    
                    About Data Synchronization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../integrations/adobeanalytics.html">
            
                <a href="../integrations/adobeanalytics.html">
            
                    
                    Adobe Analytics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../integrations/crashlytics.html">
            
                <a href="../integrations/crashlytics.html">
            
                    
                    Crashlytics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../integrations/googleanalytics.html">
            
                <a href="../integrations/googleanalytics.html">
            
                    
                    Google Analytics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../integrations/mixpanel.html">
            
                <a href="../integrations/mixpanel.html">
            
                    
                    Mixpanel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../integrations/apptentive.html">
            
                <a href="../integrations/apptentive.html">
            
                    
                    Apptentive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../integrations/appdynamics.html">
            
                <a href="../integrations/appdynamics.html">
            
                    
                    AppDynamics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../integrations/newrelic.html">
            
                <a href="../integrations/newrelic.html">
            
                    
                    New Relic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="../integrations/splunkmint.html">
            
                <a href="../integrations/splunkmint.html">
            
                    
                    Splunk Mint
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Push Notifications</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="push-notifications">Push Notifications</h1>
<p>When working with push notifications, many of our customers see value by tracking push notifications opens - and segmenting according to data that was created by that push message - meaning sessions which began after the open of the message.</p>
<p>This helps our customers to analyze the impact of a push message by watching the video recordings of such sessions and looking at heatmaps of data which was generated by the push message.</p>
<h2 id="tracking-push-notifications">Tracking Push Notifications</h2>
<p>On iOS, in order to track opening of push notification please add to your didReceiveRemoteNotification the following code snippet, it is possible that if already tracking a push message, some of this code will already be present and just extend it as required. This code specifically will wait for 10 seconds before firing the open event to ensure both Clicktale already started to record and this open is actually an actionable session. It fires our code in a background thread.</p>
<p>This code will also send the entire payload (userInfo) to Clicktale as the event data - it is recommended to change this to something that would make it easier for you to track (like a push message id, a title or anything that would have some business meaning) as the value is search-able inside of the Clicktale for Apps platform.</p>
<p>Also note, that we only track the opening of a push message, and not the arrival of one, this is because we are looking to link a session recording to the data, and there is no session unless the push message was opened.</p>
<pre><code class="lang-objectivec">- (<span class="hljs-keyword">void</span>)application:(<span class="hljs-built_in">UIApplication</span> *)application didReceiveRemoteNotification:(<span class="hljs-built_in">NSDictionary</span> *)userInfo fetchCompletionHandler:(<span class="hljs-keyword">void</span> (^)(<span class="hljs-built_in">UIBackgroundFetchResult</span> result))completionHandler
{
    <span class="hljs-comment">// other code</span>

    <span class="hljs-comment">//We wait for the application to start and for a new Clicktale recording session to start</span>
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="hljs-number">10</span> * <span class="hljs-built_in">NSEC_PER_SEC</span>)), dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH,<span class="hljs-number">0</span>), ^{

        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">UIApplication</span>.sharedApplication.applicationState == <span class="hljs-built_in">UIApplicationStateActive</span>)
        {
            <span class="hljs-built_in">NSError</span> *error;
            <span class="hljs-built_in">NSData</span> *jsonData = [<span class="hljs-built_in">NSJSONSerialization</span> dataWithJSONObject:userInfo options:<span class="hljs-built_in">NSJSONWritingPrettyPrinted</span> error:&amp;error];

            <span class="hljs-keyword">if</span> (error == <span class="hljs-literal">nil</span> &amp;&amp; jsonData != <span class="hljs-literal">nil</span>)
            {
                [[Clicktale sharedInstance]trackEvent:<span class="hljs-string">@&quot;RemoteNotificationReceived&quot;</span> value:[[<span class="hljs-built_in">NSString</span> alloc] initWithData:jsonData encoding:<span class="hljs-built_in">NSUTF8StringEncoding</span>]];
            }
            <span class="hljs-keyword">else</span>
            {
                [[Clicktale sharedInstance]trackEvent:<span class="hljs-string">@&quot;RemoteNotificationReceived&quot;</span>];
            }
        }

    });

    <span class="hljs-comment">// other code</span>
}
</code></pre>
<p>Or with Swift:</p>
<pre><code class="lang-swift"> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">application</span><span class="hljs-params">(<span class="hljs-number">_</span> application: UIApplication, didReceiveRemoteNotification userInfo: [AnyHashable : Any], fetchCompletionHandler completionHandler: @escaping <span class="hljs-params">(UIBackgroundFetchResult)</span></span></span> -&gt; <span class="hljs-type">Void</span>) {
        <span class="hljs-comment">// other code</span>

        <span class="hljs-comment">//We wait for the application to start and for a new Clicktale recording session to start</span>
        <span class="hljs-type">DispatchQueue</span>.global().asyncAfter(deadline: .now() + <span class="hljs-number">10.0</span>)
        {
            <span class="hljs-keyword">if</span>(<span class="hljs-type">UIApplication</span>.shared.applicationState == .active)
            {
                <span class="hljs-keyword">do</span>
                {
                    <span class="hljs-keyword">let</span> jsonData = <span class="hljs-keyword">try</span> <span class="hljs-type">JSONSerialization</span>.data(withJSONObject: userInfo, options: .prettyPrinted)

                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> jsonString =  <span class="hljs-type">String</span>(bytes: jsonData, encoding: <span class="hljs-type">String</span>.<span class="hljs-type">Encoding</span>.utf8)
                    {
                        <span class="hljs-type">Clicktale</span>.sharedInstance().trackEvent(<span class="hljs-string">&quot;RemoteNotificationReceived&quot;</span>, value: jsonString)
                    }
                }
                <span class="hljs-keyword">catch</span>
                {
                    <span class="hljs-type">Clicktale</span>.sharedInstance().trackEvent(<span class="hljs-string">&quot;RemoteNotificationReceived&quot;</span>)
                }
            }
        }

        <span class="hljs-comment">// other code      </span>
    }
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="using-events.html" class="navigation navigation-prev " aria-label="Previous page: Using Events">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="advanced-features.html" class="navigation navigation-next " aria-label="Next page: Advanced Features">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Push Notifications","level":"1.2.5","depth":2,"next":{"title":"Advanced Features","level":"1.2.6","depth":2,"path":"ios/advanced-features.md","ref":"ios/advanced-features.md","articles":[]},"previous":{"title":"Using Events","level":"1.2.4","depth":2,"path":"ios/using-events.md","ref":"ios/using-events.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Clicktale for Apps","gitbook":"*"},"file":{"path":"ios/push-notifications.md","mtime":"2017-02-13T16:12:40.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-07-27T12:45:07.210Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

